name: Daily API Caller

on:
  # 定时触发配置
  schedule:
    # GitHub Actions 使用的是 UTC 时间。
    # 北京时间(UTC+8)的早上 6:00，对应 UTC 时间的前一天晚上 22:00
    - cron: '0 22 * * *'
  
  # 允许你在 GitHub 网页上通过按钮手动点击运行（方便测试）
  workflow_dispatch:

jobs:
  run-script:
    runs-on: ubuntu-latest
    
    steps:
      - name: 检出代码
        uses: actions/checkout@v4
        
      - name: 设置 Python 环境
        uses: actions/setup-python@v5
        with:
          python-version: '3.10'
          
      - name: 安装依赖包
        # 脚本用到了 aiohttp，需要安装
        run: pip install aiohttp
        
      - name: 运行 API 调用脚本
        # 这里将 GitHub 的安全变量传入脚本
        env:
          API_URL: ${{ secrets.API_URL }}
          API_KEY: ${{ secrets.API_KEY }}
          MODEL: ${{ secrets.MODEL }}
        run: python api_caller.py
